## 10.2 케라스로 다층 퍼셉트론 구현

### 10.2.2 이미지 분류기 만들기

> tensorflow 와 keras import

```python
import tensorflow as tf
from tensorflow import keras
print(tf.__version__)
print(keras.__version__)
```

> 케라스를 사용하여 데이터셋 적재

```python
fashion_mnist = keras.datasets.fashion_mnist
(X_train_full, y_train_full), (X_test, y_test) = fashion_mnist.load_data()
print(X_train_full.shape) # (60000, 28, 28)
print(X_train_full.dtype) # uint8
```

> 데이터셋 0 ~ 1로 정규화 및 훈련 세트와 테스트 세트로 나누기

```python
X_valid, X_train = X_train_full[:5000] / 255.0, X_train_full[5000:] / 255.0
y_valid, y_train = y_train_full[:5000], y_train_full[5000:]
X_test = X_test / 255.0
```

> 클래스 이름 리스트 생성

```python
class_names = ["T-shirt/top","Trouser","Pullover","Dress","Coat","Sandal","Shirt","Sneaker","Bag","Ankle boot"]
print(class_names[y_train[0]]) # Coat
```

> 시퀀셜 API로 모델 만들기

```python
# 시퀀설 모델 생성 : 순서대로 연결된 층을 일렬로 쌓는 구성
model = keras.models.Sequential()

# Flatten : 입력 이미지를 1차원으로 펼치기
model.add(keras.layers.Flatten(input_shape=[28, 28]))

# 300개의 뉴런을 가진 은닉층 추가. 활성화 함수 ReLU.
# 가중치 및 편향을 관리한다.
model.add(keras.layers.Dense(300, activation="relu"))

# 100개의 뉴런을 가진 은닉층 추가. 활성화 함수 ReLU.
model.add(keras.layers.Dense(100, activation="relu"))

# 10개의 뉴런을 가진 출력층 추가. 출력 함수 softmax
model.add(keras.layers.Dense(10, activation="softmax"))

# 모델의 모든 층 출력
model.summary()

```

> 모델 컴파일

```python
# 손실함수, 최적화방법, 평가 지표 설정
model.compile(loss="sparse_categorical_crossentropy", optimizer="sgd", metrics=["accuracy"])
```

> 모델 훈련과 평가

```python
# 입력 특성, 타깃 클래스, 훈련할 에포크 횟수, 검증 세트(선택 사항)
history = model.fit(X_train, y_train, epochs=30, validation_data = (X_valid, y_valid))
"""
# 훈련 경과, 훈련세트에 대한 손실 함수, 훈련세트에 대한 측정지표, 검증세트에 대한 손실함수, 검증세트에 대한 측정지표 
Epoch 30/30
1719/1719 [==============================] - 5s 3ms/step - loss: 0.2261 - accuracy: 0.9190 - val_loss: 0.3241 - val_accuracy: 0.8882
"""
```

